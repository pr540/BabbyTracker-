{% extends "base.html" %}

{% block content %}
<div class="dashboard">
    <!-- Online/Offline Sync Indicator -->
    <div id="syncStatus" class="sync-indicator">
        <i class="fa-solid fa-cloud-check"></i> <span>Connected</span>
    </div>

    <!-- Status Card -->
    <!-- Status Card and Baby Profile -->
    <div class="welcome-banner" style="display: flex; justify-content: space-between; align-items: flex-start;">
        <div>
            <h1>Hello, {{ baby.name }}! {% if baby.gender == 'Girl' %}ðŸŽ€{% else %}ðŸ§¸{% endif %}</h1>
            <p>Parenting made easy.</p>
        </div>
        {% if baby.photo_url %}
        <div class="baby-photo-large">
            <img src="{{ baby.photo_url }}" alt="{{ baby.name }}">
        </div>
        {% endif %}
    </div>

    <div class="status-card {% if ongoing_sleep %}sleeping{% else %}awake{% endif %}">
        <div class="status-icon">
            {% if ongoing_sleep %}
            <i class="fa-solid fa-moon"></i>
            {% else %}
            <i class="fa-solid fa-sun"></i>
            {% endif %}
        </div>
        <div class="status-text">
            <h2>{% if ongoing_sleep %}Sleeping{% else %}Awake{% endif %}</h2>
            <p>{% if ongoing_sleep %}Started at {{ ongoing_sleep.start_time.strftime('%H:%M') }}{% else %}Ready for
                nap?{% endif %}</p>
        </div>
    </div>

    <!-- Back Button & Title -->
    <div style="margin-bottom: 24px;">
        <a href="/"
            style="text-decoration: none; color: var(--text-muted); display: flex; align-items: center; gap: 8px; font-weight: 600;">
            <i class="fa-solid fa-arrow-left"></i> Back to Home
        </a>
    </div>

    <!-- Night Summary Card (Only on Monitor Screen) -->
    <div class="night-summary-card">
        <div class="summary-header">
            <i class="fa-solid fa-moon"></i>
            <h3>Last Night Summary</h3>
        </div>
        <div class="summary-stats">
            <div class="s-item">
                <span class="s-val">{{ night_cries | default(0) }}</span>
                <span class="s-lab">Cries</span>
            </div>
            <div class="s-item">
                <span class="s-val">{{ night_wakeups | default(0) }}</span>
                <span class="s-lab">Wakeups</span>
            </div>
            <div class="s-item">
                <span class="s-val">{{ night_sleep_hours | default(0) }}h</span>
                <span class="s-lab">Sleep</span>
            </div>
        </div>
    </div>

    <!-- Actions -->
    <div class="actions-container">
        <form action="/sleep/toggle" method="post" style="width: 100%;">
            <input type="hidden" name="auto_monitor" value="true">
            <button type="submit"
                class="action-btn big-btn full-width {% if ongoing_sleep %}wake-btn{% else %}sleep-btn{% endif %}">
                {% if ongoing_sleep %}
                <i class="fa-solid fa-moon"></i>
                <span>Wake Up</span>
                {% else %}
                <i class="fa-solid fa-bed"></i>
                <span>Sleep</span>
                {% endif %}
            </button>
        </form>
    </div>

    <div id="monitorScreen" class="main-screen active">
        <!-- Monitor Mode -->
        <div class="monitor-container" id="monitorSection">
            <div class="monitor-card">
                <div class="monitor-status">
                    <i class="fa-solid fa-video-slash"></i>
                    <div class="m-text">
                        <h4>Baby Monitor Mode</h4>
                        <p id="monitorLabel">Monitoring for cries & wakeups</p>
                    </div>
                </div>
                <button id="toggleMonitorBtn" class="monitor-toggle">
                    <i class="fa-solid fa-power-off"></i> Start Monitoring
                </button>
            </div>
        </div>
        <div class="stat-card" style="margin-top: 24px; text-align: left;">
            <p><i class="fa-solid fa-info-circle"></i> Place the phone near the baby. Keep the app open.</p>
        </div>
    </div>
</div>
{% endblock %}